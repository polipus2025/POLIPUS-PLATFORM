# AgriTrace360™ - Agricultural Commodity Compliance Management System

## Overview

AgriTrace360™ is a comprehensive web application for the Liberia Agriculture Commodity Regulatory Authority (LACRA), designed to manage and monitor agricultural commodity compliance across Liberian counties. It provides real-time tracking of commodities, inspections, certifications, and compliance metrics through an intuitive dashboard. The system aims to enhance transparency, efficiency, and regulatory oversight in Liberia's agricultural sector, contributing to food safety, sustainable practices, and adherence to international standards like the EU Deforestation Regulation (EUDR). It offers multi-role access for regulatory staff, farmers, field agents, and exporters, streamlining workflows from farm to export.

## User Preferences

Preferred communication style: Simple, everyday language.

**Maintenance Page Preference**: Always use the generic maintenance page template (red gradient background, "Website Maintenance" title, no specific branding) for any maintenance page requests. This template is stored in server/index.ts as inline HTML.

**Module Development Strategy**: Ready to simultaneously develop all 7 new modules (Live Trace, Land Map360, Mine Watch, Forest Guard, Aqua Trace, Blue Carbon 360, Carbon Trace) with complete functionality, maintaining consistent ISMS.online-inspired design system and professional standards from AgriTrace360. Will create full database schemas, backend APIs, frontend interfaces, and cross-module integration for each portal.

## Main Landing Page Configuration (CONFIRMED & FINAL)
- **PRIMARY HOMEPAGE**: Polipus main page with 8 modules and login buttons is the ONLY landing page
- **LANDING PAGE ROUTE**: /landing shows Polipus main page (FrontPage component) - CONFIRMED CORRECT
- **DEFAULT ROUTES**: All main routes (/, /front-page, /home, /main, /index, /landing) serve Polipus FrontPage
- **CLEAN SYSTEM STATUS**: Deep system cleanup completed - cache cleared, processes restarted
- **MODULE STRUCTURE**: 8 specialized modules confirmed:
  1. Agricultural Traceability & Compliance (ACTIVE - complete LACRA system with all existing functions)
  2. Live Trace (Livestock movement monitoring and control system)
  3. Land Map360 (Land mapping and dispute prevention services)
  4. Mine Watch (Mineral resource protection and community safeguarding)
  5. Forest Guard (Forest protection and carbon credit management)
  6. Aqua Trace (Ocean & river monitoring with fishing rights protection)
  7. Blue Carbon 360 (Conservation economics and real economic benefits)
  8. Carbon Trace (Environmental monitoring and carbon credit certification)
- **ACCESS POINTS**: Multiple routes all point to Polipus main landing page
- **LOGIN ACCESS**: Through Agricultural Traceability module → /portals → portal login options
- **MONITORING PORTAL FIX**: Login flow fixed - monitoring users stay in monitoring dashboard after login
- **ADMIN CONTROLS**: Super Backend and Central Control dashboard buttons exclusively on Platform Monitoring Dashboard
- **NAVIGATION**: Back to Monitoring buttons added to Mobile App Dashboard and Central Control Dashboard
- **INDEPENDENT LOGOUT**: Both admin dashboards logout independently and return to Platform Monitoring Dashboard
- **FARMER PORTAL INTEGRATION FIX**: Resolved critical issue where batch codes generated by farmers in the batch code generator weren't appearing in the verification system. Now when farmers create batch codes, they automatically create both commodity records AND tracking records, enabling real-time verification through the Certificate Verification System.
- **POLIPUS MAINTENANCE PAGE**: Created dedicated Polipus maintenance page featuring authentic branding, 8-module system display, professional design with progress indicators, and direct HTML serving that bypasses Vite middleware. Accessible at /polipus-maintenance and /maintenance-polipus routes.
- **RED MAINTENANCE MODE ACTIVATED**: Successfully implemented AgriTrace360 red maintenance page as the main landing page at root route (/). System now displays agricultural traceability maintenance page with proper branding, progress indicators, and auto-refresh functionality. Uses inline HTML approach to bypass file serving conflicts and ensure consistent delivery.
- **COMPLETE 8-MODULE SYSTEM RESTORED**: Successfully disabled maintenance mode and restored full Polipus platform with all 8 specialized modules active. Module 1 (Agricultural Traceability & Compliance) provides complete LACRA system access, while modules 2-8 feature professional portals. Configuration: MAINTENANCE_MODE=false in server/index.ts. Platform fully operational with PWA support and mobile app download functionality.
- **COMPLETE 8-MODULE SYSTEM ACTIVE**: Successfully implemented and confirmed working complete Polipus platform with all 8 specialized modules. Module 1 (Agricultural Traceability & Compliance) provides full access to existing LACRA system, while modules 2-8 feature professional coming-soon portals with detailed descriptions and independent routing. All modules clickable from main landing page with proper functionality confirmed by user testing.
- **SYSTEM-WIDE MAPPING STANDARDIZATION COMPLETED**: Successfully implemented comprehensive EUDR compliance and deforestation reporting across ALL mapping components throughout the AgriTrace360 platform. Enhanced Interactive Boundary Mapper, GPS Map Viewer, GIS Mapping page, and Commodity Form with unified compliance report generation system featuring professional LACRA letterhead PDFs. All mapping functionality now provides instant EUDR compliance assessment and deforestation analysis with colorful government reports for regulatory documentation.

## System Architecture

The application employs a modern full-stack architecture with a clear separation of concerns.

### UI/UX Decisions
- **Design System**: Implemented an elegant and refined ISMS.online-inspired design system across the entire platform. This includes a modern slate/blue color palette, large metric numbers with professional typography, clean white cards with subtle shadows, colored icon backgrounds, and smooth hover transitions.
- **Branding**: Official LACRA branding is integrated throughout the platform, including logos and portal titles, along with AgriTrace360 branding. EU logos are incorporated for EUDR compliance sections.
- **Responsiveness**: Fully mobile-responsive design optimized for all devices, including a comprehensive Progressive Web App (PWA) with offline capabilities and native app-like experience.
- **Dashboard Layouts**: Intuitive dashboards with real-time metrics, regional overviews, and specialized views for different user roles. Farmer dashboards feature a card-based design with gradient colors.

### Technical Implementations
- **Frontend**: Built with React (TypeScript), using Wouter for routing, TanStack React Query for state management, shadcn/ui components (Radix UI primitives), Tailwind CSS for styling, and Vite for building.
- **Backend**: Developed with Node.js (Express.js) in TypeScript, featuring a RESTful API pattern.
- **Database**: PostgreSQL, managed with Drizzle ORM (PostgreSQL dialect) and Drizzle Kit for schema migrations. Uses JWT tokens and bcrypt for authentication.
- **Authentication**: A three-tier, role-based authentication system with separate portals for regulatory staff, farmers, field agents, and exporters. Includes JWT token-based session management and secure bcrypt password hashing.
- **Geographic Integration**: Authentic Liberian geographic data, including all 15 counties, major cities, and transportation networks, is integrated into the GIS mapping system.
- **Mobile Integration**: Complete Progressive Web App (PWA) implementation with comprehensive mobile standalone functionality. Features automatic installation prompts, offline-first architecture, service worker caching, background sync, push notifications, custom app icons, platform-specific installation guides, and native app-like experience. Includes PWA-enabled protection page for secure deployment.
- **Messaging**: A comprehensive cross-portal internal messaging system with threading, role-based filtering, unread tracking, and blinking red notification indicators.
- **Reporting & Analytics**: Advanced statistics dashboards, audit trail monitoring, and comprehensive county agricultural reports with PDF download capabilities.
- **Simulation**: Real-time simulation system for commodities data, demonstrating dynamic compliance rates and updates.
- **Super Backend Control System**: Comprehensive administrative control system with PostgreSQL database integration (8 specialized tables), real-time system monitoring, feature flag management, emergency controls, performance metrics collection, audit logging, background health checks, and professional monitoring portal interface. Accessible at /super-backend and /monitor endpoints with complete system oversight capabilities.
- **Central Control Center**: Enhanced administrative platform providing complete control over all platform aspects, including user management, data synchronization, security controls, system maintenance, and emergency operations. Features real-time metrics, tabbed interface, and comprehensive platform management tools. Now includes GIS system control (satellite imagery, GPS tracking, deforestation alerts, map optimization), mobile app management (push notifications, version control, offline mode, background sync), vehicle and fleet tracking controls for real-time monitoring and route optimization, and comprehensive audit system for independent audit compliance. The audit system tracks all user activities, decision-making processes, communications (internal messages, audio/video), financial transactions, input data, and system responses, providing complete transparency for regulatory compliance and independent audits. Accessible at /central-control endpoint.

### Feature Specifications
- **Core Modules**: Export order management, LACRA compliance integration, farmer partnerships, analytics, inspection management, certification issuance.
- **Compliance Monitoring**: Real-time compliance status tracking with detailed metrics (overall, quality, documentation, traceability scores), issue tracking, and recommendations.
- **EUDR Compliance**: Dedicated dashboard for the EU Deforestation Regulation, including risk assessments, documentation, and automated alerts, with action buttons for report generation, certificate export, satellite monitoring data, and risk assessment scheduling.
- **Farm Management**: Farmer onboarding, GPS land mapping (boundary generation, soil analysis, water sources), crop planning, and profile management with image uploads.
- **GIS Mapping**: Interactive SVG/Leaflet-based GIS mapping with Liberia country outline, county boundaries, farm plot visualization, real-time satellite monitoring (Sentinel-2, Landsat-8), GPS tracking, and deforestation alerts (Global Forest Watch API, NASA Earth Observation System).
- **Supply Chain Visibility**: Real-time GPS vehicle tracking and QR code scanning for produce movement from farm to destination.
- **International Standards**: Integration of international certification standards (EU, US, Fair Trade, crop-specific, quality/safety) for export applications.
- **Access Control**: Comprehensive role-based access control (RBAC), including territorial restrictions for field agents and restricted access to sensitive features (GIS mapping, crop planning) for regulatory staff only.
- **Offline Functionality**: Offline data synchronization mechanism with conflict resolution for users without internet connectivity.
- **Alerts**: Mobile app alert system for field agents to submit requests to the director dashboard. Anonymous abuse reporting system for integrity violations.
- **Export System**: Comprehensive export permit submission and license management system for exporters, including certificate attachments and renewal processes.
- **System Testing**: Comprehensive testing system integrated into the monitoring dashboard for automated validation of all website functionality.

## External Dependencies

### Core Libraries
- **@neondatabase/serverless**: PostgreSQL database connection
- **drizzle-orm**: Type-safe ORM for database interactions
- **@tanstack/react-query**: Server state management and caching
- **react-hook-form**: Form handling and validation
- **@hookform/resolvers**: Zod schema resolver for form validation
- **zod**: Runtime type validation and schema definition

### UI Libraries
- **@radix-ui/react-***: Accessible UI component primitives
- **tailwindcss**: Utility-first CSS framework
- **lucide-react**: Icon library
- **recharts**: Data visualization components

### Geographic & Satellite APIs
- **Global Forest Watch API**: Deforestation monitoring and forest change detection.
- **NASA Earth Observation System**: Integration with NASA satellites (Terra, Aqua, Landsat, SMAP, VIIRS, GPM Core) for agricultural products, vegetation indices, and soil moisture data.
- **OpenStreetMap data (via Leaflet)**: Real interactive mapping.
- **REST Countries API**: Authentic country geographic data.
- **Sentinel-2 and Landsat-8 (indirect via imagery providers)**: Satellite imagery for environmental monitoring.
- **Google Earth Engine, Sentinel Hub, USGS Earth Explorer, ESA Copernicus, Farmonaut, Agromonitoring APIs**: Real satellite imagery providers.